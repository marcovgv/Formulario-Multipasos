<!DOCTYPE html>
<html lang="es" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>Formulario Multipasos </title>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* Ajustes para m√≥viles */
@media (max-width: 600px) {
  /* Contenedor m√°s ancho en m√≥viles */
  .container {
    max-width: 100%;
    padding: 15px;
  }

  /* Texto pasos centrado y m√°s peque√±o */
  .progress-bar p {
    font-size: 0.75rem;
  }

  /* Cancha con proporci√≥n fija y adaptable */
  #cancha {
    width: 100vw; /* ocupar ancho total del m√≥vil */
    max-width: 100%;
    height: auto;
    aspect-ratio: 1.7 / 1;
    border-width: 3px;
    border-radius: 30px / 15px;
  }

  /* Jugadores y posiciones un poco m√°s grandes para tocar mejor */
  .jugador {
    width: 40px;
    height: 40px;
    font-size: 16px;
    line-height: 40px;
  }

  .posicion {
    width: 36px;
    height: 36px;
    border-width: 2px;
  }

  /* Botones m√°s grandes y anchos */
  button {
    min-width: 100%;
    padding: 14px 0;
    font-size: 18px;
  }

  /* Margen y padding para inputs mejor t√°ctil */
  input, select {
    font-size: 1.1rem;
    padding: 12px;
  }
}
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: Arial, sans-serif;
      }
      body {
        background: #f5f6fa;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 15px;
      }
      .container {
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        width: 100%;
        max-width: 500px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      header {
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 20px;
        text-align: center;
      }

      .progress-bar {
        display: flex;
        justify-content: space-between;
        position: relative;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }
      .progress-bar::before {
        content: "";
        position: absolute;
        top: 14px;
        left: 30px;
        width: calc(100% - 60px);
        height: 4px;
        background: #dcdde1;
        z-index: 0;
      }
      .step {
        text-align: center;
        z-index: 1;
        flex: 1;
        min-width: 60px;
      }
      .step p {
        font-size: 0.8rem;
        margin-bottom: 5px;
        color: #7f8c8d;
        transition: color 0.3s ease;
      }
      .step p.active {
        color: green;
        font-weight: bold;
      }
      .bullet {
        width: 25px;
        height: 25px;
        border-radius: 50%;
        background: #dcdde1;
        display: inline-block;
        line-height: 25px;
        color: white;
        position: relative;
        transition: background 0.3s ease;
      }
      .bullet.active {
        background: green;
      }
      .check {
        display: none;
        color: white;
        position: absolute;
        top: 0;
        left: 0;
        width: 25px;
        height: 25px;
        line-height: 25px;
        border-radius: 50%;
        background: green;
        font-size: 12px;
      }
      .check.active {
        display: block;
      }

      .form-outer {
        width: 100%;
        overflow: hidden;
      }
      form {
        display: flex;
        width: 400%;
      }
      .page {
        width: 25%;
        padding: 10px;
        transition: margin-left 0.5s ease-in-out;
      }
      .field {
        margin-bottom: 15px;
      }
      label {
        display: block;
        font-size: 0.9rem;
        margin-bottom: 5px;
      }
      input,
      select {
        width: 100%;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 1rem;
      }
      .btns {
        display: flex;
        justify-content: space-between;
        gap: 10px;
        flex-wrap: wrap;
      }
      button {
        flex: 1;
        min-width: 100px;
        padding: 8px 16px;
        background: green;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
      }
      button:hover {
        background: darkgreen;
      }
      .success-message {
        text-align: center;
        padding: 20px;
      }
      .success-message h2 {
        color: green;
        margin-bottom: 10px;
      }

      /* RESPONSIVE */
      @media (max-width: 600px) {
        .progress-bar {
          flex-direction: column;
          align-items: center;
        }
        .progress-bar::before {
          display: none;
        }
        .step {
          margin-bottom: 10px;
        }
        .page {
          padding: 5px;
        }
        input,
        select,
        button {
          font-size: 1rem;
        }
      }

      /*cancha*/
      .posicion.drop-effect {
        animation: scaleUp 0.3s ease;
      }

      @keyframes scaleUp {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.3);
        }
        100% {
          transform: scale(1);
        }
      }

      #jugadores {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        max-width: 1000px;
        margin-bottom: 15px;
        gap: 8px;
        background: white;
        padding: 10px;
        border-radius: 10px;
        border: 2px solid #ccc;
        width: 90%;
      }

      .jugador-wrapper {
        position: relative;
        user-select: none;
      }

      .jugador {
        width: 45px;
        height: 45px;
        background-color: red;
        color: white;
        font-weight: bold;
        border-radius: 50%;
        line-height: 45px;
        cursor: move;
        text-align: center;
        font-size: 14px;
        box-shadow: 0 0 5px #a00;
        transition: transform 0.2s;
      }

      .jugador:active {
        transform: scale(1.1);
      }

      .tooltip {
        visibility: hidden;
        width: 150px;
        background-color: black;
        color: #fff;
        text-align: center;
        padding: 8px;
        border-radius: 5px;
        position: absolute;
        top: -90px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s;
        font-size: 12px;
        pointer-events: none;
      }

      .jugador-wrapper:hover .tooltip {
        visibility: visible;
        opacity: 1;
      }

      #cancha {
        width: 95vw;
       
        max-height: 530px;
        background-image: url("canchas.jpeg");
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        border: 5px solid #004d00;
        border-radius: 50px / 20px;
        position: relative;
        box-shadow: 0 0 15px #006600aa inset;
        margin-bottom: 25px;
        user-select: none;
        overflow: hidden;
        max-width: 100%;
  height: auto;
  aspect-ratio: 1.7 / 1;
      }

      .posicion {
        width: 40px;
        height: 40px;
        border: 2px dashed white;
        border-radius: 50%;
        position: absolute;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: rgba(255, 255, 255, 0.1);
        cursor: pointer;
        transition: background-color 0.3s;
        user-select: none;
      }

      .posicion:hover {
        background-color: rgba(255, 255, 255, 0.25);
      }

      /* Posiciones espec√≠ficas */
      .p1 {
        top: 50%;
        left: 3%;
      }
      .p2 {
        top: 30%;
        left: 10%;
      }
      .p3 {
        top: 70%;
        left: 10%;
      }
      .p4 {
        top: 40%;
        left: 18%;
      }
      .p5 {
        top: 60%;
        left: 18%;
      }
      .p6 {
        top: 35%;
        left: 30%;
      }
      .p7 {
        top: 65%;
        left: 30%;
      }
      .p8 {
        top: 30%;
        left: 45%;
      }
      .p9 {
        top: 70%;
        left: 45%;
      }
      .p10 {
        top: 50%;
        left: 50%;
      }
      .p11 {
        top: 25%;
        left: 65%;
      }
      .p12 {
        top: 75%;
        left: 65%;
      }
      .p13 {
        top: 35%;
        left: 75%;
      }
      .p14 {
        top: 65%;
        left: 75%;
      }
      .p15 {
        top: 45%;
        left: 80%;
      }
      .p16 {
        top: 55%;
        left: 80%;
      }
      .p17 {
        top: 35%;
        left: 90%;
      }
      .p18 {
        top: 65%;
        left: 90%;
      }

      .botones {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 15px;
        width: 90%;
        max-width: 600px;
        margin-bottom: 30px;
      }

      button {
        padding: 12px 25px;
        font-size: 16px;
        border: none;
        border-radius: 7px;
        cursor: pointer;
        background-color: #004d00;
        color: white;
        transition: background 0.3s;
        min-width: 170px;
        user-select: none;
        box-shadow: 0 0 8px #003300aa;
      }

      button:hover {
        background-color: #007700;
      }

      @media (max-width: 500px) {
        .jugador {
          width: 36px;
          height: 36px;
          font-size: 12px;
          line-height: 36px;
        }
        .posicion {
          width: 32px;
          height: 32px;
        }
        button {
          min-width: 100%;
        }
      }
     #tarjeta-jugador {
  position: relative; /* Cambiado para que est√© dentro del flujo del formulario */
  top: auto;
  left: auto;
  margin-top: 15px;
  width: 100%;
  max-width: 400px;
  pointer-events: auto;
  opacity: 1;
  transition: none;
  box-shadow: none;
}
    </style>
  </head>
  <body>
    <div class="container">
      <header>Formulario</header>
      <div class="progress-bar">
        <div class="step">
          <p>Registro</p>
          <div class="bullet"><span>1</span></div>
          <div class="check fas fa-check"></div>
        </div>
        <div class="step">
          <p>Cancha</p>
          <div class="bullet"><span>2</span></div>
          <div class="check fas fa-check"></div>
        </div>

       

      <div class="form-outer">
        <form id="multiForm">
          <!-- Paso 1 -->
          <div class="page slide-page">
            <div class="field">
              <label for="nombre">Nombre Completo</label
              ><input type="text" id="nombre" name="nombre" required />
            </div>
            <div class="field">
              <label for="apellidos">Apellidos</label
              ><input type="text" id="apellidos" name="apellidos" required />
            </div>
            <div class="field">
              <label for="telefono">Tel√©fono</label
              ><input
                type="tel"
                id="telefono"
                name="telefono"
                pattern="[0-9]{10}"
                required
              />
            </div>
            <div class="field">
              <label for="correo">Correo Electr√≥nico</label
              ><input type="email" id="correo" name="correo" required />
            </div>
            <div class="field">
              <button type="button" class="next">Siguiente</button>
            </div>
          </div>

          <!-- Paso 2 -->
          <div class="page">
            <h1>Arrastra y suelta los jugadores a la cancha</h1>

            <div id="jugadores"></div>

            <div id="cancha">
              <div class="posicion p1"></div>
              <div class="posicion p2"></div>
              <div class="posicion p3"></div>
              <div class="posicion p4"></div>
              <div class="posicion p5"></div>
              <div class="posicion p6"></div>
              <div class="posicion p7"></div>
              <div class="posicion p8"></div>
              <div class="posicion p9"></div>
              <div class="posicion p10"></div>
              <div class="posicion p11"></div>
              <div class="posicion p12"></div>
              <div class="posicion p13"></div>
              <div class="posicion p14"></div>
              <div class="posicion p15"></div>
              <div class="posicion p16"></div>
              <div class="posicion p17"></div>
              <div class="posicion p18"></div>
            </div>

            <div id="tarjeta-jugador" style="display: none">
              <h3 id="nombre-jugador"></h3>
              <p>N√∫mero: <span id="numero-jugador"></span></p>
              <img
                id="imagen-jugador"
                src="./camisa-jugador.png"
                width="60"
                height="60"
                alt="Camiseta jugador"
              />
            </div>

            <div class="botones">
              <button onclick="capturarCancha()">üì∑ Capturar Posiciones</button>
            </div>
            <div class="field btns">
              <button type="button" class="prev">Atr√°s</button
              ><button type="button" class="next">Siguiente</button>
            </div>
          </div>

        

          <!-- Paso 3 -->
          
        </form>
      </div>
    </div>
    <!-- Formulario -->
    <script>
      const slidePage = document.querySelector(".slide-page");
      const form = document.getElementById("multiForm");
      const progressText = document.querySelectorAll(".step p");
      const progressCheck = document.querySelectorAll(".step .check");
      const bullet = document.querySelectorAll(".step .bullet");
      const pages = document.querySelectorAll(".page");
      let current = 1;

      function validatePage(index) {
        const inputs = pages[index].querySelectorAll("input, select");
        for (let input of inputs) {
          if (!input.checkValidity()) {
            input.reportValidity();
            return false;
          }
        }
        return true;
      }

      function goToPage(stepOffset) {
        const currentIndex = current - 1;
        if (stepOffset > 0 && !validatePage(currentIndex)) return;
        const newIndex = currentIndex + stepOffset;
        slidePage.style.marginLeft = `${-25 * newIndex}%`;

        if (stepOffset > 0) {
          bullet[current - 1].classList.add("active");
          progressCheck[current - 1].classList.add("active");
          progressText[current - 1].classList.add("active");
          current++;
        } else {
          bullet[current - 2].classList.remove("active");
          progressCheck[current - 2].classList.remove("active");
          progressText[current - 2].classList.remove("active");
          current--;
        }
      }

      document.querySelectorAll(".next").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          goToPage(1);
        });
      });

      document.querySelectorAll(".prev").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          goToPage(-1);
        });
      });

      form.addEventListener("submit", function (event) {
        event.preventDefault();
        if (!validatePage(current - 1)) return;
        bullet[current - 1].classList.add("active");
        progressCheck[current - 1].classList.add("active");
        progressText[current - 1].classList.add("active");
        document.querySelector(".form-outer").innerHTML = `
        <div class="success-message">
          <h2>¬°Registro exitoso!</h2>
          <p>Gracias por registrarte. Te hemos enviado un correo de confirmaci√≥n.</p>
        </div>
      `;
      });

      // Soporte para Swipe
      let touchStartX = 0;
      let touchEndX = 0;
      const threshold = 50; // distancia m√≠nima para detectar swipe

      form.addEventListener("touchstart", (e) => {
        touchStartX = e.changedTouches[0].screenX;
      });

      form.addEventListener("touchend", (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      });

      function handleSwipe() {
        const diff = touchEndX - touchStartX;
        if (Math.abs(diff) > threshold) {
          if (diff < 0) {
            goToPage(1); // Swipe izquierda ‚Üí siguiente
          } else {
            goToPage(-1); // Swipe derecha ‚Üí anterior
          }
        }
      }
    </script>
    <!-- Script para la cancha -->
    <script>
      const jugadoresContainer = document.getElementById("jugadores");
      const posiciones = document.querySelectorAll(".posicion");

      const nombres = [
        "Portero",
        "Lateral Izq.",
        "Lateral Der.",
        "Central 1",
        "Central 2",
        "Medio Def. 1",
        "Medio Def. 2",
        "Medio Of. 1",
        "Medio Of. 2",
        "Enganche",
        "Delantero Izq.",
        "Delantero Der.",
        "Extremo Izq.",
        "Extremo Der.",
        "Punta 1",
        "Punta 2",
        "Segundo Punta",
        "Falso 9",
      ];

      const camisetaUrl = "./camisa-jugador.png";

      // Crear jugadores con wrapper que tiene id
      for (let i = 1; i <= 18; i++) {
        const wrapper = document.createElement("div");
        wrapper.className = "jugador-wrapper";
        wrapper.id = "jugador-wrapper" + i;

        const jugador = document.createElement("div");
        jugador.className = "jugador";
        jugador.id = "jugador" + i;
        jugador.draggable = true;
        jugador.textContent = i;
        jugador.addEventListener("dragstart", dragStart);

        const tooltip = document.createElement("div");
        tooltip.className = "tooltip";
        tooltip.innerHTML = `
          <strong>${nombres[i - 1]}</strong><br>
          <img src="${camisetaUrl}" width="40" height="40" />
        `;

        wrapper.appendChild(jugador);
        wrapper.appendChild(tooltip);
        jugadoresContainer.appendChild(wrapper);
      }

      function dragStart(e) {
        // Enviar el id del wrapper
        e.dataTransfer.setData("text", e.target.parentElement.id);
      }

      // Permitir drop sobre las posiciones
      posiciones.forEach((pos) => {
        pos.addEventListener("dragover", (e) => {
          e.preventDefault();
        });

        pos.addEventListener("drop", (e) => {
          e.preventDefault();
          const wrapperId = e.dataTransfer.getData("text");
          const wrapper = document.getElementById(wrapperId);

          // Evitar que ya haya un jugador en esa posici√≥n
          if (pos.children.length === 0) {
            pos.appendChild(wrapper);

            pos.classList.add("drop-effect");
            setTimeout(() => {
              pos.classList.remove("drop-effect");
            }, 300);
          }
        });
      });

      // Funci√≥n para capturar cancha con html2canvas
      function capturarCancha() {
        const cancha = document.getElementById("cancha");
        html2canvas(cancha).then((canvas) => {
          // Abre la imagen en nueva pesta√±a
          const dataURL = canvas.toDataURL("image/png");
          const nuevaVentana = window.open();
          nuevaVentana.document.write(
            `<img src="${dataURL}" alt="Captura cancha">`
          );
        });
      }

      const tarjeta = document.getElementById("tarjeta-jugador");
      const nombreJugadorElem = document.getElementById("nombre-jugador");
      const numeroJugadorElem = document.getElementById("numero-jugador");

      // A√±adir evento click a cada jugador para mostrar info en tarjeta
      document.querySelectorAll(".jugador").forEach((jugador) => {
        jugador.addEventListener("click", () => {
          const id = jugador.id; // ej. jugador1, jugador2...
          const numero = id.replace("jugador", "");
          const nombre = nombres[parseInt(numero) - 1];

          nombreJugadorElem.textContent = nombre;
          numeroJugadorElem.textContent = numero;

          tarjeta.style.display = "block";
        });
      });
    </script>
  </body>
</html>

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cancha de Jugadores</title>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

    <style>
      * {
        box-sizing: border-box;
      }

      .posicion.drop-effect {
        animation: scaleUp 0.3s ease;
      }

      @keyframes scaleUp {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.3);
        }
        100% {
          transform: scale(1);
        }
      }

      #jugadores {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        max-width: 1000px;
        margin-bottom: 15px;
        gap: 8px;
        background: white;
        padding: 10px;
        border-radius: 10px;
        border: 2px solid #ccc;
        width: 90%;
      }

      .jugador-wrapper {
        position: relative;
        user-select: none;
      }

      .jugador {
        width: 45px;
        height: 45px;
        background-color: red;
        color: white;
        font-weight: bold;
        border-radius: 50%;
        line-height: 45px;
        cursor: move;
        text-align: center;
        font-size: 14px;
        box-shadow: 0 0 5px #a00;
        transition: transform 0.2s;
      }

      .jugador:active {
        transform: scale(1.1);
      }

      .tooltip {
        visibility: hidden;
        width: 150px;
        background-color: black;
        color: #fff;
        text-align: center;
        padding: 8px;
        border-radius: 5px;
        position: absolute;
        top: -90px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        opacity: 0;
        transition: opacity 0.3s;
        font-size: 12px;
        pointer-events: none;
      }

      .jugador-wrapper:hover .tooltip {
        visibility: visible;
        opacity: 1;
      }

      #cancha {
        width: 95vw;
        max-width: 900px;
        height: calc(95vw / 1.7);
        max-height: 530px;
        background-image: url("canchas.jpeg");
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        border: 5px solid #004d00;
        border-radius: 50px / 20px;
        position: relative;
        box-shadow: 0 0 15px #006600aa inset;
        margin-bottom: 25px;
        user-select: none;
        overflow: hidden;
      }

      .posicion {
        width: 40px;
        height: 40px;
        border: 2px dashed white;
        border-radius: 50%;
        position: absolute;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: rgba(255, 255, 255, 0.1);
        cursor: pointer;
        transition: background-color 0.3s;
        user-select: none;
      }

      .posicion:hover {
        background-color: rgba(255, 255, 255, 0.25);
      }

      /* Posiciones espec√≠ficas */
      .p1 {
        top: 50%;
        left: 3%;
      }
      .p2 {
        top: 30%;
        left: 10%;
      }
      .p3 {
        top: 70%;
        left: 10%;
      }
      .p4 {
        top: 40%;
        left: 18%;
      }
      .p5 {
        top: 60%;
        left: 18%;
      }
      .p6 {
        top: 35%;
        left: 30%;
      }
      .p7 {
        top: 65%;
        left: 30%;
      }
      .p8 {
        top: 30%;
        left: 45%;
      }
      .p9 {
        top: 70%;
        left: 45%;
      }
      .p10 {
        top: 50%;
        left: 50%;
      }
      .p11 {
        top: 25%;
        left: 65%;
      }
      .p12 {
        top: 75%;
        left: 65%;
      }
      .p13 {
        top: 35%;
        left: 75%;
      }
      .p14 {
        top: 65%;
        left: 75%;
      }
      .p15 {
        top: 45%;
        left: 80%;
      }
      .p16 {
        top: 55%;
        left: 80%;
      }
      .p17 {
        top: 35%;
        left: 90%;
      }
      .p18 {
        top: 65%;
        left: 90%;
      }

      .botones {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 15px;
        width: 90%;
        max-width: 600px;
        margin-bottom: 30px;
      }

      button {
        padding: 12px 25px;
        font-size: 16px;
        border: none;
        border-radius: 7px;
        cursor: pointer;
        background-color: #004d00;
        color: white;
        transition: background 0.3s;
        min-width: 170px;
        user-select: none;
        box-shadow: 0 0 8px #003300aa;
      }

      button:hover {
        background-color: #007700;
      }

      @media (max-width: 500px) {
        .jugador {
          width: 36px;
          height: 36px;
          font-size: 12px;
          line-height: 36px;
        }
        .posicion {
          width: 32px;
          height: 32px;
        }
        button {
          min-width: 100%;
        }
      }
      #tarjeta-jugador {
        position: absolute;
        top: 100px; /* Ajusta seg√∫n necesites */
        left: 960px; /* Un poco a la derecha de la cancha (que tiene max-width 900px) */
        width: 200px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 0 10px #333;
        padding: 15px;
        user-select: none;
        font-family: Arial, sans-serif;
        color: #004d00;
      }
    </style>
  </head>
  <body>
    <h1>Arrastra y suelta los jugadores a la cancha</h1>

    <div id="jugadores"></div>

    <div id="cancha">
      <div class="posicion p1"></div>
      <div class="posicion p2"></div>
      <div class="posicion p3"></div>
      <div class="posicion p4"></div>
      <div class="posicion p5"></div>
      <div class="posicion p6"></div>
      <div class="posicion p7"></div>
      <div class="posicion p8"></div>
      <div class="posicion p9"></div>
      <div class="posicion p10"></div>
      <div class="posicion p11"></div>
      <div class="posicion p12"></div>
      <div class="posicion p13"></div>
      <div class="posicion p14"></div>
      <div class="posicion p15"></div>
      <div class="posicion p16"></div>
      <div class="posicion p17"></div>
      <div class="posicion p18"></div>
    </div>

    <div id="tarjeta-jugador" style="display:none;">
      <h3 id="nombre-jugador"></h3>
      <p>N√∫mero: <span id="numero-jugador"></span></p>
      <img
        id="imagen-jugador"
        src="./camisa-jugador.png"
        width="60"
        height="60"
        alt="Camiseta jugador"
      />
    </div>

    <div class="botones">

      <button onclick="capturarCancha()">üì∑ Capturar Posiciones</button>
    </div>

    <script>
      const jugadoresContainer = document.getElementById("jugadores");
      const posiciones = document.querySelectorAll(".posicion");

      const nombres = [
        "Portero",
        "Lateral Izq.",
        "Lateral Der.",
        "Central 1",
        "Central 2",
        "Medio Def. 1",
        "Medio Def. 2",
        "Medio Of. 1",
        "Medio Of. 2",
        "Enganche",
        "Delantero Izq.",
        "Delantero Der.",
        "Extremo Izq.",
        "Extremo Der.",
        "Punta 1",
        "Punta 2",
        "Segundo Punta",
        "Falso 9",
      ];

      const camisetaUrl = "./camisa-jugador.png";

      // Crear jugadores con wrapper que tiene id
      for (let i = 1; i <= 18; i++) {
        const wrapper = document.createElement("div");
        wrapper.className = "jugador-wrapper";
        wrapper.id = "jugador-wrapper" + i;

        const jugador = document.createElement("div");
        jugador.className = "jugador";
        jugador.id = "jugador" + i;
        jugador.draggable = true;
        jugador.textContent = i;
        jugador.addEventListener("dragstart", dragStart);

        const tooltip = document.createElement("div");
        tooltip.className = "tooltip";
        tooltip.innerHTML = `
          <strong>${nombres[i - 1]}</strong><br>
          <img src="${camisetaUrl}" width="40" height="40" />
        `;

        wrapper.appendChild(jugador);
        wrapper.appendChild(tooltip);
        jugadoresContainer.appendChild(wrapper);
      }

      function dragStart(e) {
        // Enviar el id del wrapper
        e.dataTransfer.setData("text", e.target.parentElement.id);
      }

      // Permitir drop sobre las posiciones
      posiciones.forEach((pos) => {
        pos.addEventListener("dragover", (e) => {
          e.preventDefault();
        });

        pos.addEventListener("drop", (e) => {
          e.preventDefault();
          const wrapperId = e.dataTransfer.getData("text");
          const wrapper = document.getElementById(wrapperId);

          // Evitar que ya haya un jugador en esa posici√≥n
          if (pos.children.length === 0) {
            pos.appendChild(wrapper);

            pos.classList.add("drop-effect");
            setTimeout(() => {
              pos.classList.remove("drop-effect");
            }, 300);
          }
        });
      });

   
      // Funci√≥n para capturar cancha con html2canvas
      function capturarCancha() {
        const cancha = document.getElementById("cancha");
        html2canvas(cancha).then((canvas) => {
          // Abre la imagen en nueva pesta√±a
          const dataURL = canvas.toDataURL("image/png");
          const nuevaVentana = window.open();
          nuevaVentana.document.write(`<img src="${dataURL}" alt="Captura cancha">`);
        });
      }

      const tarjeta = document.getElementById("tarjeta-jugador");
      const nombreJugadorElem = document.getElementById("nombre-jugador");
      const numeroJugadorElem = document.getElementById("numero-jugador");

      // A√±adir evento click a cada jugador para mostrar info en tarjeta
      document.querySelectorAll(".jugador").forEach((jugador) => {
        jugador.addEventListener("click", () => {
          const id = jugador.id; // ej. jugador1, jugador2...
          const numero = id.replace("jugador", "");
          const nombre = nombres[parseInt(numero) - 1];

          nombreJugadorElem.textContent = nombre;
          numeroJugadorElem.textContent = numero;

          tarjeta.style.display = "block";
        });
      });
    </script>
  </body>
</html>
